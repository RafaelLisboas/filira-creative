<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filira Creative - Sua Papelaria Criativa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        /* Animação do Gradiente para o Background da Página */
        @keyframes animatedPageBackground {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body {
            font-family: 'Inter', sans-serif;
            background-image: linear-gradient(
                to right,
                rgba(253, 230, 138, 0.85), /* Amarelo claro translúcido */
                rgba(251, 207, 232, 0.85), /* Rosa claro translúcido */
                rgba(252, 182, 203, 0.80),/* Rosa um pouco mais forte translúcido */
                rgba(253, 230, 138, 0.85)
            );
            background-size: 300% 300%;
            animation: animatedPageBackground 25s ease-in-out infinite;
            overflow-x: hidden;
        }

        .pacifico-font {
            font-family: 'Pacifico', cursive;
        }

        .hero-bg {
            position: relative;
            z-index: 1;
        }

        .hero-bg > .container {
            position: relative; 
            z-index: 2;
        }

        .section-title {
            @apply text-3xl md:text-4xl font-semibold text-center mb-10 pacifico-font text-pink-500;
        }
        .card {
            @apply bg-white rounded-xl shadow-lg overflow-hidden transform transition-all duration-300 hover:scale-105;
        }
        .btn {
            @apply px-6 py-3 rounded-lg font-semibold transition-colors duration-300;
        }
        .btn-primary {
            @apply bg-pink-500 text-white hover:bg-pink-600;
        }
        .btn-secondary {
            @apply bg-yellow-400 text-gray-800 hover:bg-yellow-500;
        }
        .btn-gemini {
            @apply bg-purple-500 text-white hover:bg-purple-600 inline-flex items-center;
        }
        .nav-link {
            @apply text-gray-700 hover:text-pink-500 px-3 py-2 rounded-md text-sm font-medium transition-colors;
        }
        .active-link {
            @apply text-pink-500 font-semibold;
        }

        header, section, footer {
            position: relative;
            z-index: 1;
        }
        .loader {
            border: 4px solid #f3f3f3; /* Light grey */
            border-top: 4px solid #E91E63; /* Pink */
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .gemini-result-card {
            @apply bg-white p-4 rounded-lg shadow-md mb-3 border-l-4 border-pink-400;
        }
        .color-palette div {
            @apply w-10 h-10 rounded-full shadow-md mx-1;
        }
        #musicToggleButton {
            @apply fixed bottom-4 right-4 bg-pink-500 text-white p-3 rounded-full shadow-lg hover:bg-pink-600 transition-colors z-50;
        }
    </style>
</head>
<body>

    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#home" class="flex items-center text-pink-500 hover:text-pink-600 transition-colors">
                <img src="imagens/coloque a mão dela no rosto (1).png" alt="Logótipo Filira Creative" class="h-8 w-8 md:h-10 md:w-10 mr-2 rounded-full" onerror="this.onerror=null;this.src='https://placehold.co/40x40/F48FB1/FFFFFF?text=FC';">
                <span class="text-2xl md:text-3xl font-bold pacifico-font">Filira Creative</span>
            </a>
            <div class="hidden md:flex space-x-4">
                <a href="#home" class="nav-link active-link">Início</a>
                <a href="#products" class="nav-link">Produtos</a>
                <a href="#about" class="nav-link">Sobre Nós</a>
                <a href="#gemini-features" class="nav-link">Inspiração ✨</a>
                <a href="#contact" class="nav-link">Contato</a>
            </div>
            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-gray-700 hover:text-pink-500 focus:outline-none">
                    <i class="fas fa-bars fa-lg"></i>
                </button>
            </div>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden bg-white shadow-lg">
            <a href="#home" class="block nav-link text-center py-2">Início</a>
            <a href="#products" class="block nav-link text-center py-2">Produtos</a>
            <a href="#about" class="block nav-link text-center py-2">Sobre Nós</a>
            <a href="#gemini-features" class="block nav-link text-center py-2">Inspiração ✨</a>
            <a href="#contact" class="block nav-link text-center py-2">Contato</a>
        </div>
    </header>

    <section id="home" class="hero-bg text-gray-800 py-20 md:py-32">
        <div class="container mx-auto px-6 text-center">
            <h1 class="text-4xl md:text-6xl font-bold pacifico-font mt-6 mb-40 drop-shadow-md">Sua Criatividade Começa Aqui!</h1>
            <p class="text-lg md:text-xl mt-8 mb-8 max-w-2xl mx-auto">Descubra um universo de cores, texturas e possibilidades na Filira Creative. Tudo o que você precisa para dar vida às suas ideias.</p>
            <a href="#products" class="btn btn-primary text-lg">Explore Nossos Produtos</a>
        </div>
    </section>

    <section id="featured-products" class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="section-title">Destaques Criativos</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="card">
                    <img src="https://placehold.co/400x300/FCE4EC/E91E63?text=Caderno+Especial" alt="Caderno Especial" class="w-full h-48 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x300/CCCCCC/FFFFFF?text=Imagem+Indisponível';">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold mb-2 text-gray-800">Caderno Pontilhado Floral</h3>
                        <p class="text-gray-600 mb-4 text-sm">Perfeito para bullet journal e anotações criativas.</p>
                        <span class="text-pink-500 font-bold text-lg">R$ 35,90</span>
                        <button class="mt-4 w-full btn btn-secondary">Ver Detalhes</button>
                    </div>
                </div>
                <div class="card">
                    <img src="https://placehold.co/400x300/FFF9C4/FFC107?text=Canetas+Coloridas" alt="Canetas Coloridas" class="w-full h-48 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x300/CCCCCC/FFFFFF?text=Imagem+Indisponível';">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold mb-2 text-gray-800">Kit Canetas Fineliner</h3>
                        <p class="text-gray-600 mb-4 text-sm">Cores vibrantes para seus desenhos e letterings.</p>
                        <span class="text-pink-500 font-bold text-lg">R$ 49,90</span>
                        <button class="mt-4 w-full btn btn-secondary">Ver Detalhes</button>
                    </div>
                </div>
                <div class="card">
                    <img src="https://placehold.co/400x300/E1F5FE/03A9F4?text=Aquarelas" alt="Aquarelas" class="w-full h-48 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x300/CCCCCC/FFFFFF?text=Imagem+Indisponível';">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold mb-2 text-gray-800">Estojo de Aquarela Pastilha</h3>
                        <p class="text-gray-600 mb-4 text-sm">24 cores intensas para suas obras de arte.</p>
                        <span class="text-pink-500 font-bold text-lg">R$ 79,90</span>
                        <button class="mt-4 w-full btn btn-secondary">Ver Detalhes</button>
                    </div>
                </div>
                <div class="card">
                    <img src="https://placehold.co/400x300/C8E6C9/4CAF50?text=Washi+Tapes" alt="Washi Tapes" class="w-full h-48 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x300/CCCCCC/FFFFFF?text=Imagem+Indisponível';">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold mb-2 text-gray-800">Coleção Washi Tapes Sonhos</h3>
                        <p class="text-gray-600 mb-4 text-sm">Decore seus planners e cadernos com estilo.</p>
                        <span class="text-pink-500 font-bold text-lg">R$ 22,50</span>
                        <button class="mt-4 w-full btn btn-secondary">Ver Detalhes</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="products" class="py-16 bg-pink-50">
        <div class="container mx-auto px-6">
            <h2 class="section-title">Navegue por Categorias</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="relative rounded-xl overflow-hidden group"><img src="https://placehold.co/600x400/E1BEE7/9C27B0?text=Cadernos+e+Planners" alt="Cadernos e Planners" class="w-full h-64 object-cover transform transition-transform duration-500 group-hover:scale-110" onerror="this.onerror=null;this.src='https://placehold.co/600x400/CCCCCC/FFFFFF?text=Imagem+Indisponível';"><div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center"><h3 class="text-white text-2xl font-semibold pacifico-font">Cadernos & Planners</h3></div></div>
                <div class="relative rounded-xl overflow-hidden group"><img src="https://placehold.co/600x400/BBDEFB/2196F3?text=Escrita+e+Desenho" alt="Escrita e Desenho" class="w-full h-64 object-cover transform transition-transform duration-500 group-hover:scale-110" onerror="this.onerror=null;this.src='https://placehold.co/600x400/CCCCCC/FFFFFF?text=Imagem+Indisponível';"><div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center"><h3 class="text-white text-2xl font-semibold pacifico-font">Escrita & Desenho</h3></div></div>
                <div class="relative rounded-xl overflow-hidden group"><img src="https://placehold.co/600x400/D1C4E9/673AB7?text=Materiais+Artísticos" alt="Materiais Artísticos" class="w-full h-64 object-cover transform transition-transform duration-500 group-hover:scale-110" onerror="this.onerror=null;this.src='https://placehold.co/600x400/CCCCCC/FFFFFF?text=Imagem+Indisponível';"><div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center"><h3 class="text-white text-2xl font-semibold pacifico-font">Materiais Artísticos</h3></div></div>
                <div class="relative rounded-xl overflow-hidden group"><img src="https://placehold.co/600x400/FFCDD2/F44336?text=Organização" alt="Organização" class="w-full h-64 object-cover transform transition-transform duration-500 group-hover:scale-110" onerror="this.onerror=null;this.src='https://placehold.co/600x400/CCCCCC/FFFFFF?text=Imagem+Indisponível';"><div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center"><h3 class="text-white text-2xl font-semibold pacifico-font">Organização</h3></div></div>
                <div class="relative rounded-xl overflow-hidden group"><img src="https://placehold.co/600x400/FFF59D/FFEB3B?text=Papéis+Especiais" alt="Papéis Especiais" class="w-full h-64 object-cover transform transition-transform duration-500 group-hover:scale-110" onerror="this.onerror=null;this.src='https://placehold.co/600x400/CCCCCC/FFFFFF?text=Imagem+Indisponível';"><div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center"><h3 class="text-white text-2xl font-semibold pacifico-font">Papéis Especiais</h3></div></div>
                <div class="relative rounded-xl overflow-hidden group"><img src="https://placehold.co/600x400/CFD8DC/607D8B?text=Acessórios" alt="Acessórios Criativos" class="w-full h-64 object-cover transform transition-transform duration-500 group-hover:scale-110" onerror="this.onerror=null;this.src='https://placehold.co/600x400/CCCCCC/FFFFFF?text=Imagem+Indisponível';"><div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center"><h3 class="text-white text-2xl font-semibold pacifico-font">Acessórios</h3></div></div>
            </div>
        </div>
    </section>
    
    <section id="about" class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="section-title">Nossa História</h2>
            <div class="flex flex-col md:flex-row items-center gap-10">
                <div class="md:w-1/2"><img src="https://placehold.co/600x400/F8BBD0/E91E63?text=Equipe+Filira+Creative" alt="Sobre Filira Creative" class="rounded-xl shadow-lg w-full" onerror="this.onerror=null;this.src='https://placehold.co/600x400/CCCCCC/FFFFFF?text=Imagem+Indisponível';"></div>
                <div class="md:w-1/2 text-gray-700 text-lg">
                    <p class="mb-4">Bem-vindo à <span class="pacifico-font text-pink-500">Filira Creative</span>! Nascemos da paixão por papelaria e da crença de que a criatividade pode transformar o dia a dia.</p>
                    <p class="mb-4">Nossa missão é oferecer produtos de alta qualidade que inspirem artistas, estudantes, planejadores e todos que amam o universo da papelaria. Selecionamos cada item com carinho, buscando sempre novidades e tendências para colorir suas ideias.</p>
                    <p>Mais do que uma loja, queremos ser um espaço de inspiração e fomento à criatividade. Explore, crie e divirta-se!</p>
                </div>
            </div>
        </div>
    </section>

    <section id="gemini-features" class="py-16 bg-purple-50">
        <div class="container mx-auto px-6">
            <h2 class="section-title text-purple-600">Inspiração Criativa com Gemini ✨</h2>
            <div class="grid md:grid-cols-2 gap-12">
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-2xl font-semibold mb-4 text-purple-700 pacifico-font">Gerador de Ideias para Projetos ✨</h3>
                    <p class="text-gray-600 mb-4">Sem ideias para o seu próximo projeto de papelaria? Descreva os materiais que você tem ou o tema que gostaria de explorar, e deixe a Gemini te ajudar!</p>
                    <div class="mb-4">
                        <label for="ideaKeywords" class="block text-sm font-medium text-gray-700 mb-1">Suas palavras-chave (ex: aquarela, flores, cartão):</label>
                        <input type="text" id="ideaKeywords" class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-purple-500 focus:border-purple-500" placeholder="Ex: canetas coloridas, planner, viagem">
                    </div>
                    <button id="generateIdeasButton" class="btn btn-gemini w-full">
                        <i class="fas fa-lightbulb mr-2"></i>Gerar Ideias
                    </button>
                    <div id="ideasLoader" class="hidden loader"></div>
                    <div id="ideasResult" class="mt-4 text-sm text-gray-700"></div>
                    <p class="text-xs text-gray-400 mt-2 text-right">Powered by Gemini</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-2xl font-semibold mb-4 text-purple-700 pacifico-font">Assistente de Cores para Projetos ✨</h3>
                    <p class="text-gray-600 mb-4">Quer criar uma combinação de cores perfeita? Descreva seu projeto ou o sentimento que deseja transmitir, e a Gemini sugere uma paleta!</p>
                    <div class="mb-4">
                        <label for="colorKeywords" class="block text-sm font-medium text-gray-700 mb-1">Descreva seu projeto/sentimento (ex: cartão alegre, scrapbook vintage):</label>
                        <input type="text" id="colorKeywords" class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-purple-500 focus:border-purple-500" placeholder="Ex: convite de casamento romântico">
                    </div>
                    <button id="generateColorsButton" class="btn btn-gemini w-full">
                        <i class="fas fa-palette mr-2"></i>Sugerir Cores
                    </button>
                    <div id="colorsLoader" class="hidden loader"></div>
                    <div id="colorsResult" class="mt-4 text-sm text-gray-700">
                    </div>
                     <p class="text-xs text-gray-400 mt-2 text-right">Powered by Gemini</p>
                </div>
            </div>
        </div>
    </section>

    <section class="py-16 bg-yellow-300">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-3xl font-semibold text-gray-800 mb-4">Fique por Dentro das Novidades!</h2>
            <p class="text-gray-700 mb-8 max-w-lg mx-auto">Assine nossa newsletter e receba ofertas exclusivas, dicas de criatividade e lançamentos em primeira mão.</p>
            <form action="https://formsubmit.co/seu-email-aqui" method="POST" class="flex flex-col sm:flex-row justify-center items-center gap-4 max-w-md mx-auto">
                <input type="email" name="email_newsletter" placeholder="Seu melhor e-mail" class="w-full sm:w-auto flex-grow px-4 py-3 rounded-lg border border-gray-400 focus:ring-pink-500 focus:border-pink-500" required>
                <button type="submit" class="btn btn-primary w-full sm:w-auto">Assinar Agora</button>
            </form>
        </div>
    </section>

    <section id="contact" class="py-16 bg-pink-50">
        <div class="container mx-auto px-6">
            <h2 class="section-title">Entre em Contato</h2>
            <div class="max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg">
                <form action="https://formsubmit.co/seu-email-aqui" method="POST">
                     <input type="hidden" name="_next" value="https://seusite.github.io/filira-creative/obrigado.html"> <input type="hidden" name="_subject" value="Nova Mensagem do Site Filira Creative!">
                    <div class="mb-6"><label for="name" class="block text-gray-700 font-semibold mb-2">Nome</label><input type="text" id="name" name="name" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-pink-500 focus:border-pink-500" required></div>
                    <div class="mb-6"><label for="email_contact" class="block text-gray-700 font-semibold mb-2">E-mail</label><input type="email" id="email_contact" name="email_contact" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-pink-500 focus:border-pink-500" required></div>
                    <div class="mb-6"><label for="message" class="block text-gray-700 font-semibold mb-2">Mensagem</label><textarea id="message" name="message" rows="5" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-pink-500 focus:border-pink-500" required></textarea></div>
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary text-lg mb-4">Enviar Mensagem</button>
                        <p class="text-sm text-gray-500 my-3">Ou se preferir, fale conosco diretamente:</p>
                        <a href="https://wa.me/559884898101" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-500 hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-300 w-full sm:w-auto">
                            <i class="fab fa-whatsapp fa-lg mr-2"></i> Chamar no WhatsApp
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <footer class="bg-gray-800 text-white py-10">
        <div class="container mx-auto px-6 text-center">
            <p class="pacifico-font text-2xl text-pink-400 mb-4">Filira Creative</p>
            <div class="flex justify-center space-x-6 mb-6">
                <a href="https://www.instagram.com/seu_usuario_instagram" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors"><i class="fab fa-instagram fa-2x"></i></a>
                <a href="https://www.facebook.com/sua_pagina_facebook" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors"><i class="fab fa-facebook-f fa-2x"></i></a>
                <a href="https://www.pinterest.com/seu_usuario_pinterest" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors"><i class="fab fa-pinterest-p fa-2x"></i></a>
            </div>
            <p class="text-gray-500 text-sm">&copy; <span id="currentYear"></span> Filira Creative. Todos os direitos reservados.</p>
            <p class="text-gray-500 text-sm">Feito com <i class="fas fa-heart text-pink-400"></i> para inspirar sua criatividade.</p>
        </div>
    </footer>

    <button id="musicToggleButton" title="Tocar/Pausar Música">
        <i class="fas fa-play"></i>
    </button>

    <script>
        // Mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Smooth scroll for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                mobileMenu.classList.add('hidden'); 
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({ behavior: 'smooth' });
                }
                document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active-link'));
                if (!this.classList.contains('block')) {
                    this.classList.add('active-link');
                } else {
                    const desktopLink = document.querySelector(`.hidden.md\\:flex a[href="${targetId}"]`);
                    if (desktopLink) { desktopLink.classList.add('active-link'); }
                }
            });
        });
        
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        const sections = document.querySelectorAll('section[id]');
        const navLinks = document.querySelectorAll('.nav-link:not(.block)'); 
        window.addEventListener('scroll', () => {
            let current = 'home'; 
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 70) { current = section.getAttribute('id'); }
            });
            navLinks.forEach(link => {
                link.classList.remove('active-link');
                if (link.getAttribute('href').substring(1) === current) { link.classList.add('active-link'); }
            });
            if (pageYOffset < sections[0].offsetTop - 70 && current === 'home' ) {
                 document.querySelector('.nav-link[href="#home"]').classList.add('active-link');
            } else if (!document.querySelector('.nav-link.active-link') && current === 'home') { 
                document.querySelector('.nav-link[href="#home"]').classList.add('active-link');
            }
        });

        // --- Gemini API Features ---
        const apiKey = ""; 
        const geminiApiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
        const ideaKeywordsInput = document.getElementById('ideaKeywords');
        const generateIdeasButton = document.getElementById('generateIdeasButton');
        const ideasLoader = document.getElementById('ideasLoader');
        const ideasResultDiv = document.getElementById('ideasResult');

        if (generateIdeasButton) {
            generateIdeasButton.addEventListener('click', async () => {
                const keywords = ideaKeywordsInput.value.trim();
                if (!keywords) {
                    ideasResultDiv.innerHTML = '<p class="text-red-500">Por favor, insira algumas palavras-chave.</p>';
                    return;
                }
                ideasLoader.classList.remove('hidden');
                ideasResultDiv.innerHTML = '';
                const prompt = `Gere 3 ideias criativas e curtas para projetos de papelaria usando os seguintes materiais ou temas: "${keywords}". Para cada ideia, forneça um nome criativo em negrito e uma breve descrição (1-2 frases). Formate a resposta como uma lista não ordenada.`;
                try {
                    const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                    const response = await fetch(geminiApiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) { throw new Error(`Erro na API: ${response.statusText}`); }
                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
                        let generatedText = result.candidates[0].content.parts[0].text;
                        generatedText = generatedText.replace(/\n\*/g, '<li>'); 
                        generatedText = generatedText.replace(/\n/g, '<br>'); 
                        generatedText = generatedText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>'); 
                        ideasResultDiv.innerHTML = `<ul>${generatedText}</ul>`;
                    } else {
                        ideasResultDiv.innerHTML = '<p class="text-red-500">Não foi possível gerar ideias. Tente novamente.</p>';
                        console.error('Resposta inesperada da API:', result);
                    }
                } catch (error) {
                    console.error('Erro ao gerar ideias:', error);
                    ideasResultDiv.innerHTML = `<p class="text-red-500">Ocorreu um erro: ${error.message}. Verifique o console para mais detalhes.</p>`;
                } finally {
                    ideasLoader.classList.add('hidden');
                }
            });
        }

        const colorKeywordsInput = document.getElementById('colorKeywords');
        const generateColorsButton = document.getElementById('generateColorsButton');
        const colorsLoader = document.getElementById('colorsLoader');
        const colorsResultDiv = document.getElementById('colorsResult');

        if (generateColorsButton) {
            generateColorsButton.addEventListener('click', async () => {
                const keywords = colorKeywordsInput.value.trim();
                if (!keywords) {
                    colorsResultDiv.innerHTML = '<p class="text-red-500">Por favor, descreva seu projeto ou sentimento.</p>';
                    return;
                }
                colorsLoader.classList.remove('hidden');
                colorsResultDiv.innerHTML = '';
                const prompt = `Sugira uma paleta de 3 a 5 cores que combinem com a seguinte descrição de projeto ou sentimento: "${keywords}". Forneça os nomes das cores e seus códigos hexadecimais.`;
                const schema = { type: "OBJECT", properties: { paletteName: { type: "STRING", description: "Um nome criativo para a paleta de cores." }, colors: { type: "ARRAY", description: "Uma lista de cores, cada uma com nome e código hexadecimal.", items: { type: "OBJECT", properties: { name: { type: "STRING", description: "Nome da cor (ex: Azul Céu, Rosa Suave)" }, hex: { type: "STRING", description: "Código hexadecimal da cor (ex: #87CEEB)" } }, required: ["name", "hex"] } } }, required: ["paletteName", "colors"] };
                try {
                    const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }], generationConfig: { responseMimeType: "application/json", responseSchema: schema } };
                    const response = await fetch(geminiApiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) { throw new Error(`Erro na API de cores: ${response.statusText}`); }
                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0 && result.candidates[0].content.parts[0].text) {
                        const jsonResponseText = result.candidates[0].content.parts[0].text;
                        try {
                            const parsedJson = JSON.parse(jsonResponseText);
                            let htmlOutput = `<h4 class="font-semibold text-purple-600 mb-2">${parsedJson.paletteName || 'Paleta Sugerida'}:</h4>`;
                            htmlOutput += '<div class="flex flex-wrap justify-center mb-2 color-palette">';
                            if (parsedJson.colors && Array.isArray(parsedJson.colors)) {
                                parsedJson.colors.forEach(color => { 
                                    if(color && color.hex && color.name) { 
                                        htmlOutput += `<div style="background-color: ${color.hex};" title="${color.name} (${color.hex})"></div>`;
                                    }
                                });
                            }
                            htmlOutput += '</div>';
                            htmlOutput += '<ul class="list-disc list-inside">';
                            if (parsedJson.colors && Array.isArray(parsedJson.colors)) {
                                parsedJson.colors.forEach(color => { 
                                     if(color && color.hex && color.name) { 
                                        htmlOutput += `<li>${color.name}: <span class="font-mono">${color.hex}</span></li>`;
                                     }
                                });
                            }
                            htmlOutput += '</ul>';
                            colorsResultDiv.innerHTML = htmlOutput;
                        } catch (parseError) {
                            console.error('Erro ao fazer parse da resposta JSON de cores:', parseError, "\nTexto recebido:", jsonResponseText);
                            colorsResultDiv.innerHTML = '<p class="text-red-500">A resposta da API de cores não pôde ser processada. Tente novamente.</p>';
                        }
                    } else {
                        colorsResultDiv.innerHTML = '<p class="text-red-500">Não foi possível gerar a paleta de cores. Tente novamente.</p>';
                        console.error('Resposta inesperada da API de cores (sem candidates válidos):', result);
                    }
                } catch (error) {
                    console.error('Erro ao gerar paleta de cores:', error);
                    colorsResultDiv.innerHTML = `<p class="text-red-500">Ocorreu um erro ao buscar cores: ${error.message}.</p>`;
                } finally {
                    colorsLoader.classList.add('hidden');
                }
            });
        }

        // --- Música de Fundo com Tone.js ---
        const musicToggleButton = document.getElementById('musicToggleButton');
        let musicPlaying = false;
        let pluckSynth, musicSequence; // Renomeado para clareza
        let audioContextUserInteracted = false; 

        function setupAquarelaMusic() {
            // PluckSynth para um som que lembra violão
            pluckSynth = new Tone.PluckSynth({
                attackNoise: 0.5, // Um pouco de ruído no ataque para simular o "pluck"
                dampening: 4000,   // Amortecimento das cordas (ajuste para sustain)
                resonance: 0.7,   // Ressonância do corpo do instrumento
                volume: -14       // Volume mais baixo para música de fundo
            }).toDestination();

            // Melodia inspirada em "Aquarela" - simplificada para PluckSynth
            // Foco nas frases melódicas principais e harmonias simples
            // As notas são representadas como [tempo, nota, duraçãoOpcional]
            // '4n' = semínima, '2n' = mínima, '1m' = compasso inteiro
            const aquarelaMelody = [
                // Introdução / Tema A (Numa folha qualquer...)
                { time: "0:0:0", note: "G4", duration: "2n" },
                { time: "0:2:0", note: "E4", duration: "2n" },
                { time: "1:0:0", note: "C4", duration: "2n" },
                { time: "1:2:0", note: "D4", duration: "4n" },
                { time: "1:3:0", note: "E4", duration: "4n" },

                { time: "2:0:0", note: "G4", duration: "2n" },
                { time: "2:2:0", note: "E4", duration: "2n" },
                { time: "3:0:0", note: "C4", duration: "2n" },
                { time: "3:2:0", note: "A3", duration: "2n" }, // Harmonia simples

                // Tema B (E com cinco ou seis retas...)
                { time: "4:0:0", note: "C5", duration: "4n" },
                { time: "4:1:0", note: "B4", duration: "4n" },
                { time: "4:2:0", note: "A4", duration: "2n" },
                { time: "5:0:0", note: "G4", duration: "2n" },
                { time: "5:2:0", note: "F4", duration: "4n" }, // Adicionando F# se quiser Gmaj7
                { time: "5:3:0", note: "E4", duration: "4n" },
                
                { time: "6:0:0", note: "D4", duration: "2n" },
                { time: "6:2:0", note: "C4", duration: "1m" }, // Finaliza a frase

                // Repetição suave ou variação
                { time: "8:0:0", note: "G3", duration: "2n"}, // Base harmônica
                { time: "8:2:0", note: "B3", duration: "2n"},
                { time: "9:0:0", note: "D4", duration: "2n"},
                { time: "9:2:0", note: "G4", duration: "2n"},

                { time: "10:0:0", note: "C4", duration: "2n"},
                { time: "10:2:0", note: "E4", duration: "2n"},
                { time: "11:0:0", note: "G4", duration: "2n"},
                { time: "11:2:0", note: "C5", duration: "2n"},

                { time: "12:0:0", note: "B4", duration: "4n"},
                { time: "12:1:0", note: "A4", duration: "4n"},
                { time: "12:2:0", note: "G4", duration: "2n"},
                { time: "13:0:0", note: "E4", duration: "1m"},
            ];

            musicSequence = new Tone.Part((time, value) => {
                pluckSynth.triggerAttackRelease(value.note, value.duration || "8n", time);
            }, aquarelaMelody);
            
            musicSequence.loop = true; 
            musicSequence.loopEnd = '14m'; // Ajustado para a duração da nova melodia
            Tone.Transport.bpm.value = 75; // Um pouco mais rápido para "Aquarela"
            console.log("Configuração da música 'Aquarela' concluída.");
        }

        async function controlMusicPlayback(play) {
            // Garante que o contexto de áudio foi iniciado por uma interação do usuário
            if (!audioContextUserInteracted && Tone.context.state !== 'running') {
                try {
                    await Tone.start(); 
                    console.log('Contexto de áudio iniciado.');
                    audioContextUserInteracted = true; 
                    if (!pluckSynth) { 
                        setupAquarelaMusic();
                    }
                } catch (e) {
                    console.error("Erro ao iniciar o contexto de áudio do Tone.js:", e);
                    if (musicToggleButton) musicToggleButton.innerHTML = '<i class="fas fa-exclamation-circle" title="Erro no áudio"></i>';
                    return; 
                }
            } else if (!pluckSynth) { 
                 setupAquarelaMusic();
            }

            if (play) {
                if (pluckSynth && musicSequence && (Tone.Transport.state === "stopped" || Tone.Transport.state === "paused")) {
                    Tone.Transport.start();
                    if(musicSequence.state !== "started") musicSequence.start(0); 
                    if (musicToggleButton) musicToggleButton.innerHTML = '<i class="fas fa-pause"></i>';
                    musicPlaying = true;
                    console.log("Música 'Aquarela' iniciada/retomada.");
                }
            } else { // Pause
                if (Tone.Transport.state === "started") {
                    Tone.Transport.pause(); 
                    if (musicToggleButton) musicToggleButton.innerHTML = '<i class="fas fa-play"></i>';
                    musicPlaying = false;
                    console.log("Música 'Aquarela' pausada.");
                }
            }
        }

        // Tenta tocar a música automaticamente quando a janela carregar
        window.addEventListener('load', () => {
            console.log("Janela carregada. Tentando autoplay da música 'Aquarela'...");
            // Tenta iniciar o contexto de áudio. Se bem-sucedido, a música tocará.
            // Navegadores podem bloquear isso sem interação prévia.
            // O timeout dá uma pequena chance para elementos carregarem.
            setTimeout(() => controlMusicPlayback(true), 500); 
        });
        
        // Event listener para o botão de toggle
        if (musicToggleButton) {
            musicToggleButton.addEventListener('click', () => {
                controlMusicPlayback(!musicPlaying); // Inverte o estado atual
            });
        }

        // Adiciona um listener para a primeira interação do usuário na página
        // para tentar iniciar o contexto de áudio se o autoplay no load falhar.
        function handleFirstUserInteraction() {
            if (!audioContextUserInteracted && Tone.context.state !== 'running') {
                console.log("Primeira interação do usuário detectada, tentando iniciar o áudio se necessário.");
                controlMusicPlayback(musicPlaying); // Tenta manter o estado desejado ou iniciar se era pra tocar
            }
            // Remove o listener após a primeira interação para não disparar múltiplas vezes
            document.body.removeEventListener('click', handleFirstUserInteraction, true);
            document.body.removeEventListener('keydown', handleFirstUserInteraction, true);
        }
        document.body.addEventListener('click', handleFirstUserInteraction, true);
        document.body.addEventListener('keydown', handleFirstUserInteraction, true);

    </script>
</body>
</html>